# Journal: 2026-02-12 — Lost a Training Run, Starting Over

## The Short Version

Was at epoch 44/50 yesterday with 99.69% validation accuracy. WSL rebooted overnight and killed the process. Lost the run. Had to start over from scratch today.

## What Happened

The XPS (RTX 4060 Ti, 8GB VRAM) was mid-training when Windows decided to restart WSL for reasons I still don't fully understand. The training process was PID-attached to the terminal, no checkpointing, no resume logic. 44 epochs of compute just gone.

First thing I did today was patch `train.py` so this can't happen again:
- **Resume from checkpoint:** If `best.pt` exists, it loads the model weights, optimizer state, epoch counter, and best accuracy, then picks up where it left off
- **Periodic saves:** Every 5 epochs it drops a snapshot (`epoch15_98.69.pt`, etc.) alongside the rolling `best.pt`

Should've done this from the start. Lesson learned.

## Training Run 2

Kicked off a fresh run with the same config: 50 epochs, batch size 256, cosine annealing LR schedule, early stopping patience of 10. Same CICIDS2017 dataset (2.83M flows, 78 features, 15 classes).

Progress by end of day:
- **Epoch 17/50**, train accuracy sitting at 98.65%, loss around 0.034
- Running at ~80 iterations/second, roughly an hour left
- Best validation accuracy so far: **98.69% at epoch 13**
- Some val instability — epoch 16 dropped to 95.26% which is weird but probably the cosine schedule oscillating. Should recover.

Previous run hit 99.32% around epoch 25-30 and peaked at 99.69% at epoch 44. Expecting similar trajectory this time. The model architecture hasn't changed (1D-CNN + BiLSTM, 768K params), just the training hygiene around it.

## XPS Environment

Also had to fix the training environment today. The XPS WSL got upgraded to Ubuntu 25.10 which broke the Python venv (3.12 → 3.13.7). Recreated the venv, verified PyTorch still sees the GPU (CUDA 13.1, driver 591.44), reinstalled all deps. nvidia-smi wasn't on PATH either — had to add `/usr/lib/wsl/lib` to `.bashrc`.

Built a small monitoring script (`sentinelnet-monitor.py`) that SSHs into the XPS and parses the tqdm log output into a dashboard. Shows epoch progress, train metrics, speed, ETA, and validation history. Easier than tailing the raw log which is just thousands of carriage-return tqdm lines.

## Dataset Status

CICIDS2017 parquet (353MB, HuggingFace `c01dsnap/CIC-IDS2017`) is on both XPS and ThinkStation now. The full packet-bytes variant is still downloading on ThinkStation but we don't need it for the flow classifier — that's for future work if we want to do raw packet analysis.

## Next

- Wait for training to finish overnight
- Evaluate per-class metrics (especially curious about the minority attack classes)
- ONNX export and deploy to pi2 for inference
- Then the interesting part: adversarial robustness evaluation with FGSM, PGD, and C&W
